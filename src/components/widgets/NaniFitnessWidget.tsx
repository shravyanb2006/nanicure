import { useState } from "react";
import { Button } from "@/components/ui/button";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Badge } from "@/components/ui/badge";
import { Dumbbell, Volume2 } from "lucide-react";

const fitnessCategories = [
  { id: 'yoga', label: 'Yoga Asanas', icon: 'üßò‚Äç‚ôÄÔ∏è' },
  { id: 'fat-loss', label: 'Fat Loss', icon: 'üî•' },
  { id: 'posture', label: 'Better Posture', icon: 'üìè' },
  { id: 'strength', label: 'Build Strength', icon: 'üí™' },
  { id: 'flexibility', label: 'Flexibility', icon: 'ü§∏‚Äç‚ôÄÔ∏è' },
  { id: 'morning-routine', label: 'Morning Routine', icon: 'üåÖ' },
  { id: 'cardio', label: 'Heart Health', icon: '‚ù§Ô∏è' },
  { id: 'balance', label: 'Balance & Focus', icon: '‚öñÔ∏è' },
];

export function NaniFitnessWidget() {
  const [selectedCategory, setSelectedCategory] = useState<string>('');
  const [exercises, setExercises] = useState<string>('');
  const [isPlaying, setIsPlaying] = useState(false);

  const getFitnessGuide = (category: string): string => {
    const exercise_map: Record<string, string> = {
      'yoga': `**Nani ke favorite Yoga Asanas! üßò‚Äç‚ôÄÔ∏è**

**Morning Energizers:**
‚Ä¢ **Surya Namaskar** (Sun Salutation)
  - 5 rounds to start, build to 12
  - Best done facing east at sunrise
  - Complete body workout in one sequence

‚Ä¢ **Tadasana** (Mountain Pose)
  - Stand tall, feet together, arms by sides
  - Hold 30 seconds, breathe deeply
  - Improves posture and balance

‚Ä¢ **Vrikshasana** (Tree Pose)
  - Balance on one foot, other on inner thigh
  - Hands in prayer position
  - Hold 15-30 seconds each side

**Digestion & Flexibility:**
‚Ä¢ **Balasana** (Child's Pose)
  - Kneel, sit back on heels, arms forward
  - Rest forehead on ground
  - Perfect for stress relief

‚Ä¢ **Bhujangasana** (Cobra Pose)
  - Lie face down, lift chest using arms
  - Strengthens back, opens chest
  - Hold 15-30 seconds

‚Ä¢ **Paschimottanasana** (Forward Bend)
  - Sit legs extended, reach for toes
  - Improves digestion and flexibility
  - Hold 30 seconds, breathe deeply

*Start slow beta, consistency matters more than perfection! üôè*`,

      'fat-loss': `**Fat loss ke liye Nani ka natural plan! üî•**

**Daily Movement Plan:**
‚Ä¢ **Morning Walk** - 30 minutes brisk pace
  - Empty stomach for best results
  - Add arm swings and deep breathing
  - Gradually increase speed

‚Ä¢ **Stairs Climbing** - 10 minutes daily
  - Use stairs instead of lifts
  - 2 steps at a time for extra burn
  - Great for leg strength

‚Ä¢ **Spot Exercises** (3 sets each):
  - **Squats** - 10-15 reps
  - **Push-ups** (wall/knee) - 5-10 reps  
  - **Plank** - 15-30 seconds
  - **Jumping jacks** - 20 reps

**Nani's Kitchen Cardio:**
‚Ä¢ **Dancing** while cooking - 15 minutes
‚Ä¢ **Cleaning** with extra energy
‚Ä¢ **Gardening** - squatting, bending
‚Ä¢ **Playing with kids** - best workout!

**Fat Burning Foods:**
‚Ä¢ **Green tea** with lemon - 3 cups daily
‚Ä¢ **Jeera water** first thing morning
‚Ä¢ **Triphala** at night with warm water
‚Ä¢ **Coconut oil** for cooking - burns belly fat

**Weekly Challenge:**
‚Ä¢ **Day 1-2:** Walking + Light stretches
‚Ä¢ **Day 3-4:** Add spot exercises
‚Ä¢ **Day 5-6:** Increase intensity
‚Ä¢ **Day 7:** Rest or gentle yoga

*Slow and steady beta! Small changes = big results! üåü*`,

      'posture': `**Perfect posture ke liye Nani ke exercises! üìè**

**Wall Angel Exercise:**
‚Ä¢ **Stand** against wall, back flat
‚Ä¢ **Arms** in W shape against wall
‚Ä¢ **Slide up and down** 10 times
‚Ä¢ **Do 3 sets** twice daily

**Neck & Shoulder Relief:**
‚Ä¢ **Neck rolls** - 5 each direction
‚Ä¢ **Shoulder blade squeezes** - 10 reps
‚Ä¢ **Cat-cow stretches** on hands and knees
‚Ä¢ **Door frame chest stretch** - 30 seconds

**Core Strengthening:**
‚Ä¢ **Dead bug** exercise - lie down, opposite arm/leg
‚Ä¢ **Bird dog** - on hands/knees, extend opposite limbs
‚Ä¢ **Modified plank** - start with 15 seconds
‚Ä¢ **Pelvic tilts** - lying down or standing

**Daily Habits:**
‚Ä¢ **Pillow** support for lower back when sitting
‚Ä¢ **Screen** at eye level, no neck bending
‚Ä¢ **Frequent breaks** - stand every 30 minutes
‚Ä¢ **Sleep posture** - pillow between knees

**Yoga Poses for Posture:**
‚Ä¢ **Bhujangasana** (Cobra) - strengthens back
‚Ä¢ **Gomukhasana** (Cow face) - opens shoulders  
‚Ä¢ **Marjaryasana** (Cat-cow) - spinal flexibility
‚Ä¢ **Setu Bandhasana** (Bridge) - hip flexors

**Nani's Reminder Tips:**
‚Ä¢ Set phone **reminder** every hour
‚Ä¢ **Imagine** string pulling head up
‚Ä¢ **Breathe deeply** - opens chest naturally
‚Ä¢ **Mirror check** - correct yourself kindly

*Good posture = confidence + health! Practice daily beta! üíÉ*`,

      'strength': `**Strength building ka Nani ka safe method! üí™**

**Bodyweight Strength Training:**
‚Ä¢ **Squats** - Start 5, build to 20
  - Keep knees behind toes
  - Go as low as comfortable
  - Use chair for support initially

‚Ä¢ **Wall Push-ups** - Start 5, build to 15
  - Stand arm's length from wall
  - Push against wall, lean in/out
  - Progress to incline, then floor

‚Ä¢ **Modified Lunges** - 5 each leg
  - Hold chair for balance
  - Step forward, lower back knee
  - Alternate legs, build endurance

**Functional Strength:**
‚Ä¢ **Carrying groceries** - use both arms equally
‚Ä¢ **Lifting things** - squat down, straight back
‚Ä¢ **Climbing stairs** - use leg muscles, not just momentum
‚Ä¢ **Garden work** - digging, weeding builds strength

**Resistance with Household Items:**
‚Ä¢ **Water bottles** as weights - start 500ml
‚Ä¢ **Towel stretches** - pull and resist
‚Ä¢ **Rice bags** for lifting exercises
‚Ä¢ **Resistance band** - cheap and effective

**Progressive Plan:**
‚Ä¢ **Week 1-2:** Learn form, light reps
‚Ä¢ **Week 3-4:** Add 2-3 more reps
‚Ä¢ **Week 5-6:** Increase difficulty/weight
‚Ä¢ **Week 7-8:** Add new exercises

**Recovery & Nutrition:**
‚Ä¢ **Protein** - dal, paneer, eggs, almonds
‚Ä¢ **Rest days** - alternate muscle groups
‚Ä¢ **Stretching** after each session
‚Ä¢ **Sleep** - 7-8 hours for muscle recovery

*Beta, muscles grow during rest! Don't overdo it! üèãÔ∏è‚Äç‚ôÄÔ∏è*`,

      'flexibility': `**Flexibility badhane ke Nani ke gentle stretches! ü§∏‚Äç‚ôÄÔ∏è**

**Morning Flexibility Routine:**
‚Ä¢ **Neck stretches** - side to side, up/down
‚Ä¢ **Shoulder rolls** - forward and backward
‚Ä¢ **Arm circles** - small to big
‚Ä¢ **Gentle spinal twist** - sitting or standing

**Hip Opening Sequence:**
‚Ä¢ **Butterfly pose** - soles together, gently press knees
‚Ä¢ **Hip circles** - standing, hands on hips
‚Ä¢ **Pigeon prep** - one leg forward, lean into stretch
‚Ä¢ **Figure-4 stretch** - ankle on opposite knee

**Leg Flexibility:**
‚Ä¢ **Calf stretch** - against wall or step
‚Ä¢ **Hamstring stretch** - leg on chair, reach forward
‚Ä¢ **Quad stretch** - hold ankle behind you
‚Ä¢ **IT band stretch** - cross legs, lean sideways

**Back & Spine Mobility:**
‚Ä¢ **Cat-cow stretches** - on hands and knees
‚Ä¢ **Child's pose** - knees wide, arms forward
‚Ä¢ **Spinal twist** - sitting, rotate gently
‚Ä¢ **Knee to chest** - lying down, hug knees

**Evening Wind-down Stretches:**
‚Ä¢ **Legs up the wall** - 5-10 minutes
‚Ä¢ **Gentle neck release** - ear to shoulder
‚Ä¢ **Seated forward fold** - reach for toes gently
‚Ä¢ **Happy baby pose** - lying down, hold feet

**Daily Habits:**
‚Ä¢ **Stretch while watching TV** - gentle movements
‚Ä¢ **Morning bed stretches** - before getting up
‚Ä¢ **Work breaks** - neck and shoulder releases
‚Ä¢ **Walking** with arm swings and leg kicks

*Never force stretches beta! Gentle and consistent wins! üå∏*`,

      'morning-routine': `**Perfect morning routine for healthy day! üåÖ**

**Wake Up Sequence (5-6 AM):**
‚Ä¢ **Gentle stretching** in bed - 2 minutes
‚Ä¢ **Warm water** with lemon and honey
‚Ä¢ **Gratitude** - think 3 things you're thankful for
‚Ä¢ **Fresh air** - open windows, deep breaths

**Energy Activation (15 minutes):**
‚Ä¢ **Surya Namaskar** - 3-5 rounds
‚Ä¢ **Pranayam** - Anulom Vilom 5 minutes
‚Ä¢ **Spot jogging** or **walking** - 5 minutes
‚Ä¢ **Cold face wash** - activates circulation

**Strength Building (10 minutes):**
‚Ä¢ **Squats** - 10 reps
‚Ä¢ **Wall push-ups** - 8 reps  
‚Ä¢ **Standing marches** - 20 steps
‚Ä¢ **Arm circles** - 10 each direction

**Mindfulness (5 minutes):**
‚Ä¢ **Meditation** or quiet sitting
‚Ä¢ **Positive affirmations** - "I am strong, healthy, happy"
‚Ä¢ **Day planning** - 3 main goals
‚Ä¢ **Smile practice** - releases endorphins

**Breakfast Prep Movement:**
‚Ä¢ **Dance** while making tea/coffee
‚Ä¢ **Calf raises** while waiting for food
‚Ä¢ **Gentle stretches** during cooking
‚Ä¢ **Deep breathing** while eating

**Weekly Variation:**
‚Ä¢ **Monday/Wednesday/Friday** - Strength focus
‚Ä¢ **Tuesday/Thursday** - Flexibility focus  
‚Ä¢ **Saturday** - Longer walk or yoga
‚Ä¢ **Sunday** - Gentle movements, rest day

*Morning routine sets tone for whole day beta! Start tomorrow! ‚òÄÔ∏è*`,

      'cardio': `**Heart health ke liye Nani ka cardio plan! ‚ù§Ô∏è**

**Low Impact Cardio (Beginners):**
‚Ä¢ **Brisk walking** - 20-30 minutes daily
  - Swing arms naturally
  - Breathe through nose when possible
  - Gradually increase pace

‚Ä¢ **Stair climbing** - 5-10 minutes
  - One step at a time initially
  - Use railing for support
  - Rest when needed

‚Ä¢ **Dancing** - 15-20 minutes
  - Put on favorite music
  - Move freely, have fun
  - Great for coordination too

**Moderate Intensity:**
‚Ä¢ **Marching in place** - 10 minutes
  - Lift knees higher for challenge
  - Add arm movements
  - Perfect for rainy days

‚Ä¢ **Chair exercises** - 15 minutes
  - Seated leg lifts
  - Arm pumps while walking
  - Stand-sit repetitions

‚Ä¢ **Garden cardio** - 20-30 minutes
  - Digging, raking, weeding
  - Continuous movement
  - Fresh air bonus!

**Heart Rate Monitoring:**
‚Ä¢ **Talk test** - should be able to have conversation
‚Ä¢ **Breathe comfortably** - not gasping
‚Ä¢ **Listen to body** - stop if dizzy/chest pain
‚Ä¢ **Start slow** - build gradually

**Daily Integration:**
‚Ä¢ **Take stairs** instead of elevator
‚Ä¢ **Park farther** and walk
‚Ä¢ **Play with grandchildren** actively
‚Ä¢ **House cleaning** with energy

**Heart Healthy Habits:**
‚Ä¢ **Deep breathing** exercises daily
‚Ä¢ **Laugh often** - best cardio for heart!
‚Ä¢ **Stay hydrated** - 8-10 glasses water
‚Ä¢ **Manage stress** - meditation, music

*Happy heart = long life beta! Move with joy! üíñ*`,

      'balance': `**Balance aur focus improve karne ke exercises! ‚öñÔ∏è**

**Basic Balance Training:**
‚Ä¢ **Single leg stand** - 15-30 seconds each
  - Hold chair/wall for support initially
  - Progress to eyes closed
  - Do while brushing teeth

‚Ä¢ **Heel-to-toe walking** - 10 steps
  - Walk in straight line
  - One foot directly in front of other
  - Arms out for balance

‚Ä¢ **Tree pose** (Vrikshasana)
  - Stand on one leg, other foot on inner thigh
  - Hands in prayer position
  - Focus on fixed point ahead

**Dynamic Balance Challenges:**
‚Ä¢ **Step-ups** on sturdy step - 10 each leg
‚Ä¢ **Side leg lifts** - 10 each side
‚Ä¢ **Backward walking** - slowly and carefully
‚Ä¢ **Figure-8 walking** - creates coordination

**Mind-Body Balance:**
‚Ä¢ **Tai Chi movements** - slow, flowing
‚Ä¢ **Yoga poses** with holds
‚Ä¢ **Meditation while standing** - 2-3 minutes
‚Ä¢ **Breathing while balancing** - don't hold breath

**Focus Enhancement:**
‚Ä¢ **Gaze training** - fix eyes on one point
‚Ä¢ **Counting backwards** while balancing
‚Ä¢ **Alphabet recitation** during exercises
‚Ä¢ **Color identification** in room while on one foot

**Safety Measures:**
‚Ä¢ **Always have support** nearby initially
‚Ä¢ **Clear floor area** of obstacles
‚Ä¢ **Wear non-slip shoes** or barefoot
‚Ä¢ **Practice near wall** or sturdy furniture

**Daily Practice:**
‚Ä¢ **Morning balance check** - 30 seconds each leg
‚Ä¢ **Kitchen balance** - one leg while cooking
‚Ä¢ **TV time balance** - commercial break exercises
‚Ä¢ **Evening wind-down** - gentle balance poses

*Balance prevents falls beta! Practice little but daily! üéØ*`
    };

    return exercise_map[category] || '';
  };

  const handleCategoryClick = (categoryId: string) => {
    setSelectedCategory(categoryId);
    const fitnessGuide = getFitnessGuide(categoryId);
    setExercises(fitnessGuide);
  };

  const speakExercises = () => {
    if ('speechSynthesis' in window && exercises) {
      const utterance = new SpeechSynthesisUtterance(exercises.replace(/\*/g, '').replace(/‚Ä¢/g, ''));
      utterance.rate = 0.8;
      utterance.pitch = 1.0;
      
      utterance.onstart = () => setIsPlaying(true);
      utterance.onend = () => setIsPlaying(false);
      
      speechSynthesis.speak(utterance);
    }
  };

  const renderExercises = (text: string) => {
    return text.split('\n').map((line, index) => {
      if (line.includes('**')) {
        const parts = line.split('**');
        return (
          <div key={index} className="mb-2">
            {parts.map((part, partIndex) => 
              partIndex % 2 === 1 ? <strong key={partIndex} className="text-primary">{part}</strong> : part
            )}
          </div>
        );
      }
      return <div key={index} className={line.startsWith('‚Ä¢') ? 'ml-4 mb-1 text-sm' : 'mb-1'}>{line}</div>;
    });
  };

  return (
    <Card className="widget-card h-96">
      <CardHeader className="pb-4">
        <CardTitle className="flex items-center gap-2">
          <Dumbbell className="h-5 w-5 text-primary" />
          Nani Fitness & Yoga
        </CardTitle>
        <p className="text-sm text-muted-foreground">
          Home-friendly exercises and yoga for all fitness levels
        </p>
      </CardHeader>
      
      <CardContent className="flex flex-col h-full pb-4">
        {!selectedCategory ? (
          <div className="flex-1">
            <p className="text-sm text-muted-foreground mb-4">
              Choose your fitness goal for personalized guidance:
            </p>
            <div className="grid grid-cols-2 gap-2">
              {fitnessCategories.map((category) => (
                <Button
                  key={category.id}
                  variant="outline"
                  className="p-2 h-auto text-left justify-start hover:bg-primary hover:text-primary-foreground"
                  onClick={() => handleCategoryClick(category.id)}
                >
                  <span className="mr-2">{category.icon}</span>
                  <span className="text-xs">{category.label}</span>
                </Button>
              ))}
            </div>
          </div>
        ) : (
          <>
            <div className="flex items-center justify-between mb-4">
              <Badge variant="secondary" className="text-xs">
                {fitnessCategories.find(c => c.id === selectedCategory)?.label}
              </Badge>
              <div className="flex gap-2">
                <Button variant="ghost" size="sm" onClick={() => speakExercises()} disabled={isPlaying}>
                  <Volume2 className="h-3 w-3" />
                </Button>
                <Button variant="ghost" size="sm" onClick={() => setSelectedCategory('')}>
                  ‚Üê Back
                </Button>
              </div>
            </div>
            
            <div className="flex-1 overflow-y-auto text-sm">
              {renderExercises(exercises)}
            </div>
          </>
        )}
      </CardContent>
    </Card>
  );
}